package mainTest;

import java.net.InetAddress;
import java.net.InetSocketAddress;
import java.net.SocketAddress;
import java.net.UnknownHostException;
import java.nio.ByteBuffer;
import java.nio.channels.DatagramChannel;

import org.yakindu.scr.lightswitch.LightSwitchStatemachine;

import udp.ReceiveUDP;

public class Test
{
	public static void main(String[] args) throws Exception
	{
		ReceiveUDP receive = new ReceiveUDP(InetAddress.getLoopbackAddress(), 8888);
		LightSwitchStatemachine lightSwitch = new LightSwitchStatemachine();

		lightSwitch.init();
		lightSwitch.enter();

		while (true)
		{
			String incomingMessage = receive.receive(true, InetAddress.getLoopbackAddress(), 9999);
			System.out.println("Msg: " + incomingMessage);
			
			System.out.println(""+incomingMessage.length() + incomingMessage.equalsIgnoreCase("Klick\n"));
			if (incomingMessage != null && incomingMessage.equals("Klick\n"))
			{
				System.out.println("Switch klicked");
				lightSwitch.getSCIUser().raiseOperate();
			}
			lightSwitch.runCycle();
			Thread.sleep(500);
		}
	}
}
