package mainTest;

import java.net.InetAddress;
import java.net.InetSocketAddress;
import java.net.SocketAddress;
import java.net.UnknownHostException;
import java.nio.ByteBuffer;
import java.nio.channels.DatagramChannel;

import org.yakindu.scr.lightswitch.LightSwitchStatemachine;
import org.yakindu.scr.testbrain.TestBrainStatemachine;

import udp.ReceiveUDP;

public class Test
{
	public static void main(String[] args) throws Exception
	{
		ReceiveUDP receive = new ReceiveUDP(InetAddress.getLoopbackAddress(), 8888);
		TestBrainStatemachine testBrain = new TestBrainStatemachine();

		testBrain.init();
		testBrain.enter();

		while (true)
		{
			String incomingMessage = receive.receive(true, InetAddress.getLoopbackAddress(), 9999);
			incomingMessage = incomingMessage.trim();
//			System.out.println("Msg: " + incomingMessage);
			if (incomingMessage != null && incomingMessage.equals("Klick"))
			{
				System.out.println("Switch klicked");
				lightSwitch.getSCIUser().raiseOperate();
			}
			lightSwitch.runCycle();
			Thread.sleep(500);
		}
	}
}
